<div class="file-picker-wrapper" [attr.dir]="rtl ? 'rtl' : 'ltr'">
  <pw-form-field
    [ngControl]="ngControl"
    [validation]="validation"
    [hint]="hint"
    [label]="label | pwLabelStar:showRequiredStar:ngControl"
    [labelWidth]="labelWidth"
    [labelPosition]="labelPosition"
    [inputId]="id"
    [disabled]="disabled"
    [readonly]="readonly"
    [fluid]="fluid">
    <ng-template pwTemplate="element" let-isInvalid="isInvalid">
      <div class="picker" [class.invalid]="isInvalid">
        <input
          #inputFile
          type="file"
          onclick="this.value = ''"
          [accept]="accept"
          [attr.id]="id"
          [disabled]="disabled || readonly || (fileLimit && filesToEmit.length == fileLimit)"
          (change)="_onSelect($event)"/>

        <pw-button
          appearance="text"
          [fluid]="true"
          [disabled]="disabled || readonly || (fileLimit && filesToEmit.length == fileLimit)"
          (onClick)="inputFile.click()"
          [buttonProps]="buttonProps"
          [label]="buttonLabel"/>

        @if (!filesToShow.length) {
          <div class="empty-placeholder">
            <p>{{ emptyMessage }}</p>
          </div>
        }

        @for (item of filesToShow; track item; let i = $index) {
          <div class="file-item">
            <div class="preview"
                 [style.width.px]="previewWidth"
                 [style.height.px]="previewWidth"
                 [style.minWidth.px]="previewWidth"
                 [style.minHeight.px]="previewWidth"
                 [style.maxWidth.px]="previewWidth"
                 [style.maxHeight.px]="previewWidth">
              @switch (getFileType(item.display)) {
                @case ('image') {
                  <img [src]=" item.display" [alt]="item.name">
                }
                @case ('file') {
                  <svg data-p-icon="upload"/>
                }
              }
            </div>
            <div class="info">
              <p class="file-name">{{ item.name || 'Unknown file' }}</p>
              <small class="file-size">{{ formatSize(item.size) || '-' }}</small>
              @if (item.invalidTypeError) {
                <small class="file-error">{{ item.invalidTypeError }}</small>
              }
              @if (item.invalidSizeError) {
                <small class="file-error">{{ item.invalidSizeError }}</small>
              }
            </div>
            <pw-button
              severity="danger"
              [rounded]="true"
              appearance="text"
              (onClick)="onFileDelete($event, i)">
              <ng-template pwTemplate="icon">
                <svg data-p-icon="times"/>
              </ng-template>
            </pw-button>
          </div>
        }
      </div>
    </ng-template>
  </pw-form-field>
</div>
